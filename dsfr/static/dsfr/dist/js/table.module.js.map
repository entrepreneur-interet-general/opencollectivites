{"version":3,"file":"table.module.js","sources":["../../src/core/config.js","../../src/core/api.js","../../src/table/scripts/table/constants.js","../../src/table/scripts/table/table.js","../../src/table/index.js","../../src/table/scripts/table/build.js","../../src/table/scripts/module.js"],"sourcesContent":["export const prefix = 'fr';\r\nexport const namespace = 'dsfr';\r\nexport const organisation = '@gouvfr';\r\n","import { namespace } from './config.js';\n\nconst api = window[namespace] || { core: {} };\nwindow[namespace] = api;\nexport default api;\n","import api from '../../api.js';\n\nexport const TABLE_SELECTOR = api.core.ns.selector('table');\nexport const TABLE_NOSCROLL_SELECTOR = api.core.ns('table--no-scroll');\nexport const LEFT = 'left';\nexport const RIGHT = 'right';\nexport const SHADOW_CLASS = api.core.ns('table--shadow');\nexport const SHADOW_LEFT_CLASS = api.core.ns('table--shadow-left');\nexport const SHADOW_RIGHT_CLASS = api.core.ns('table--shadow-right');\nexport const SCROLL_OFFSET = 1; // valeur en px du scroll avant laquelle le shadow s'active ou se desactive\n","import api from '../../api.js';\nimport {\n  SHADOW_CLASS,\n  SHADOW_LEFT_CLASS,\n  SHADOW_RIGHT_CLASS,\n  LEFT,\n  RIGHT,\n  TABLE_NOSCROLL_SELECTOR,\n  SCROLL_OFFSET\n} from './constants.js';\n\nclass Table {\n  constructor (table) {\n    this.init(table);\n  }\n\n  init (table) {\n    this.table = table;\n    this.table.setAttribute(api.core.ns.attr('js-table'), 'true'); // TODO: code provisoire en attendant la refacto du JS dynamique\n    this.tableElem = this.table.querySelector('table');\n    this.tableContent = this.tableElem.querySelector('tbody');\n    this.isScrollable = this.tableContent.offsetWidth > this.tableElem.offsetWidth;\n    this.caption = this.tableElem.querySelector('caption');\n    this.captionHeight = 0;\n    const scrolling = this.change.bind(this);\n    this.tableElem.addEventListener('scroll', scrolling);\n  }\n\n  change () {\n    const newScroll = this.tableContent.offsetWidth > this.tableElem.offsetWidth;\n    let firstTimeScrollable = this.tableElem.offsetWidth > this.table.offsetWidth;\n    if (newScroll || firstTimeScrollable) {\n      if (!this.table.classList.contains(TABLE_NOSCROLL_SELECTOR)) this.scroll();\n    } else {\n      if (newScroll !== this.isScrollable) this.delete();\n    }\n    this.isScrollable = newScroll;\n    firstTimeScrollable = false;\n    const captionSize = this.caption.getBoundingClientRect();\n    this.table.style.setProperty('--table-offset', captionSize.height + 'px');\n  }\n\n  delete () {\n    api.core.removeClass(this.table, SHADOW_RIGHT_CLASS);\n    api.core.removeClass(this.table, SHADOW_LEFT_CLASS);\n    api.core.removeClass(this.table, SHADOW_CLASS);\n    if (this.caption) {\n      this.tableElem.style.marginTop = '';\n      this.caption.style.top = '';\n      this.tableElem.style.marginBottom = '';\n      this.caption.style.bottom = '';\n    }\n  }\n\n  scroll () {\n    api.core.addClass(this.table, SHADOW_CLASS);\n    this.setShadowPosition();\n  }\n\n  /* affiche les blocs shadow en fonction de la position du scroll, en ajoutant la classe visible */\n  setShadowPosition () {\n    const tableScrollLeft = this.getScrollPosition(LEFT);\n    const tableScrollRight = this.getScrollPosition(RIGHT);\n\n    // on inverse en cas de lecture droite - gauche\n    if (document.documentElement.getAttribute('dir') === 'rtl') {\n      this.setShadowVisibility(RIGHT, tableScrollLeft);\n      this.setShadowVisibility(LEFT, tableScrollRight);\n    } else {\n      this.setShadowVisibility(LEFT, tableScrollLeft);\n      this.setShadowVisibility(RIGHT, tableScrollRight);\n    }\n  }\n\n  /* Donne le nombre de pixels scroll√©s honrizontalement dans un element scrollable */\n  getScrollPosition (side) {\n    let inverter = 1;\n    // on inverse en cas de lecture droite - gauche pour que la valeur de scroll soit toujours positive\n    if (document.documentElement.getAttribute('dir') === 'rtl') {\n      inverter = -1;\n    }\n    switch (side) {\n      case LEFT:\n        return this.tableElem.scrollLeft * inverter;\n      case RIGHT:\n        return this.tableContent.offsetWidth - this.tableElem.offsetWidth - this.tableElem.scrollLeft * inverter;\n      default:\n        return false;\n    }\n  }\n\n  /* ajoute la classe fr-table--shadow-right ou fr-table--shadow-right sur fr-table\n   en fonction d'une valeur de scroll et du sens (right, left) */\n  setShadowVisibility (side, scrollPosition) {\n    // si on a pas scroll, ou qu'on scroll jusqu'au bout\n    if (scrollPosition <= SCROLL_OFFSET) {\n      if (side === LEFT) api.core.removeClass(this.table, SHADOW_LEFT_CLASS);\n      else if (side === RIGHT) api.core.removeClass(this.table, SHADOW_RIGHT_CLASS);\n    } else {\n      if (side === LEFT) api.core.addClass(this.table, SHADOW_LEFT_CLASS);\n      else if (side === RIGHT) api.core.addClass(this.table, SHADOW_RIGHT_CLASS);\n    }\n  }\n}\n\nexport { Table };\n","import api from './api.js';\nimport { Table } from './scripts/table/table.js';\n\napi.Table = Table;\n\nexport default api;\n","import { TABLE_SELECTOR } from './constants';\nimport { Table } from './table';\n\nconst tables = [];\n\nconst change = () => {\n  for (let i = 0; i < tables.length; i++) tables[i].change();\n};\n\nconst build = () => {\n  const tableNodes = document.querySelectorAll(TABLE_SELECTOR);\n  for (let i = 0; i < tableNodes.length; i++) tables.push(new Table(tableNodes[i]));\n\n  window.addEventListener('resize', change);\n  window.addEventListener('orientationchange', change);\n  change();\n};\n\nexport { build };\n","/* eslint-disable no-new */\nimport api from '../api.js';\nimport { build } from './table/build.js';\nimport { TABLE_SELECTOR } from './table/constants';\n\nnew api.core.Initializer(TABLE_SELECTOR, [build]);\n"],"names":[],"mappings":";;AACO,MAAM,SAAS,GAAG,MAAM;;ACC/B,MAAM,GAAG,GAAG,MAAM,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,EAAE,EAAE,EAAE,CAAC;AAC9C,MAAM,CAAC,SAAS,CAAC,GAAG,GAAG;;ACDhB,MAAM,cAAc,GAAG,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;AACrD,MAAM,uBAAuB,GAAG,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,kBAAkB,CAAC,CAAC;AAChE,MAAM,IAAI,GAAG,MAAM,CAAC;AACpB,MAAM,KAAK,GAAG,OAAO,CAAC;AACtB,MAAM,YAAY,GAAG,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC,CAAC;AAClD,MAAM,iBAAiB,GAAG,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,oBAAoB,CAAC,CAAC;AAC5D,MAAM,kBAAkB,GAAG,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,qBAAqB,CAAC,CAAC;AAC9D,MAAM,aAAa,GAAG,CAAC,CAAC;;ACE/B,MAAM,KAAK,CAAC;AACZ,EAAE,WAAW,CAAC,CAAC,KAAK,EAAE;AACtB,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;AACrB,GAAG;AACH;AACA,EAAE,IAAI,CAAC,CAAC,KAAK,EAAE;AACf,IAAI,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;AACvB,IAAI,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE,MAAM,CAAC,CAAC;AAClE,IAAI,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;AACvD,IAAI,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;AAC9D,IAAI,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;AACnF,IAAI,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;AAC3D,IAAI,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC;AAC3B,IAAI,MAAM,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AAC7C,IAAI,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,QAAQ,EAAE,SAAS,CAAC,CAAC;AACzD,GAAG;AACH;AACA,EAAE,MAAM,CAAC,GAAG;AACZ,IAAI,MAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;AACjF,IAAI,IAAI,mBAAmB,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC;AAClF,IAAI,IAAI,SAAS,IAAI,mBAAmB,EAAE;AAC1C,MAAM,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,QAAQ,CAAC,uBAAuB,CAAC,EAAE,IAAI,CAAC,MAAM,EAAE,CAAC;AACjF,KAAK,MAAM;AACX,MAAM,IAAI,SAAS,KAAK,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,MAAM,EAAE,CAAC;AACzD,KAAK;AACL,IAAI,IAAI,CAAC,YAAY,GAAG,SAAS,CAAC;AAClC,IAAI,mBAAmB,GAAG,KAAK,CAAC;AAChC,IAAI,MAAM,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,qBAAqB,EAAE,CAAC;AAC7D,IAAI,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,WAAW,CAAC,gBAAgB,EAAE,WAAW,CAAC,MAAM,GAAG,IAAI,CAAC,CAAC;AAC9E,GAAG;AACH;AACA,EAAE,MAAM,CAAC,GAAG;AACZ,IAAI,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,EAAE,kBAAkB,CAAC,CAAC;AACzD,IAAI,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,EAAE,iBAAiB,CAAC,CAAC;AACxD,IAAI,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,EAAE,YAAY,CAAC,CAAC;AACnD,IAAI,IAAI,IAAI,CAAC,OAAO,EAAE;AACtB,MAAM,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,SAAS,GAAG,EAAE,CAAC;AAC1C,MAAM,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,GAAG,EAAE,CAAC;AAClC,MAAM,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,YAAY,GAAG,EAAE,CAAC;AAC7C,MAAM,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,GAAG,EAAE,CAAC;AACrC,KAAK;AACL,GAAG;AACH;AACA,EAAE,MAAM,CAAC,GAAG;AACZ,IAAI,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,EAAE,YAAY,CAAC,CAAC;AAChD,IAAI,IAAI,CAAC,iBAAiB,EAAE,CAAC;AAC7B,GAAG;AACH;AACA;AACA,EAAE,iBAAiB,CAAC,GAAG;AACvB,IAAI,MAAM,eAAe,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;AACzD,IAAI,MAAM,gBAAgB,GAAG,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;AAC3D;AACA;AACA,IAAI,IAAI,QAAQ,CAAC,eAAe,CAAC,YAAY,CAAC,KAAK,CAAC,KAAK,KAAK,EAAE;AAChE,MAAM,IAAI,CAAC,mBAAmB,CAAC,KAAK,EAAE,eAAe,CAAC,CAAC;AACvD,MAAM,IAAI,CAAC,mBAAmB,CAAC,IAAI,EAAE,gBAAgB,CAAC,CAAC;AACvD,KAAK,MAAM;AACX,MAAM,IAAI,CAAC,mBAAmB,CAAC,IAAI,EAAE,eAAe,CAAC,CAAC;AACtD,MAAM,IAAI,CAAC,mBAAmB,CAAC,KAAK,EAAE,gBAAgB,CAAC,CAAC;AACxD,KAAK;AACL,GAAG;AACH;AACA;AACA,EAAE,iBAAiB,CAAC,CAAC,IAAI,EAAE;AAC3B,IAAI,IAAI,QAAQ,GAAG,CAAC,CAAC;AACrB;AACA,IAAI,IAAI,QAAQ,CAAC,eAAe,CAAC,YAAY,CAAC,KAAK,CAAC,KAAK,KAAK,EAAE;AAChE,MAAM,QAAQ,GAAG,CAAC,CAAC,CAAC;AACpB,KAAK;AACL,IAAI,QAAQ,IAAI;AAChB,MAAM,KAAK,IAAI;AACf,QAAQ,OAAO,IAAI,CAAC,SAAS,CAAC,UAAU,GAAG,QAAQ,CAAC;AACpD,MAAM,KAAK,KAAK;AAChB,QAAQ,OAAO,IAAI,CAAC,YAAY,CAAC,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,UAAU,GAAG,QAAQ,CAAC;AACjH,MAAM;AACN,QAAQ,OAAO,KAAK,CAAC;AACrB,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA,EAAE,mBAAmB,CAAC,CAAC,IAAI,EAAE,cAAc,EAAE;AAC7C;AACA,IAAI,IAAI,cAAc,IAAI,aAAa,EAAE;AACzC,MAAM,IAAI,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,EAAE,iBAAiB,CAAC,CAAC;AAC7E,WAAW,IAAI,IAAI,KAAK,KAAK,EAAE,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,EAAE,kBAAkB,CAAC,CAAC;AACpF,KAAK,MAAM;AACX,MAAM,IAAI,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,EAAE,iBAAiB,CAAC,CAAC;AAC1E,WAAW,IAAI,IAAI,KAAK,KAAK,EAAE,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,EAAE,kBAAkB,CAAC,CAAC;AACjF,KAAK;AACL,GAAG;AACH;;ACpGA,GAAG,CAAC,KAAK,GAAG,KAAK;;ACAjB,MAAM,MAAM,GAAG,EAAE,CAAC;AAClB;AACA,MAAM,MAAM,GAAG,MAAM;AACrB,EAAE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC;AAC7D,CAAC,CAAC;AACF;AACA,MAAM,KAAK,GAAG,MAAM;AACpB,EAAE,MAAM,UAAU,GAAG,QAAQ,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;AAC/D,EAAE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,MAAM,CAAC,IAAI,CAAC,IAAI,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AACpF;AACA,EAAE,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;AAC5C,EAAE,MAAM,CAAC,gBAAgB,CAAC,mBAAmB,EAAE,MAAM,CAAC,CAAC;AACvD,EAAE,MAAM,EAAE,CAAC;AACX,CAAC;;AChBD;AAIA;AACA,IAAI,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,CAAC,KAAK,CAAC,CAAC"}